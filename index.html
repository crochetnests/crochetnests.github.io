<html>
  <head>
    <title>Test</title>
    <!-- <link rel="manifest" href="manifest.json"> -->
    <link rel="manifest" id="my-manifest">

  </head>
  <body>
    <p>
      If the <code>beforeinstallprompt</code> event fires, there will be a button displayed allowing
      you to use <code>prompt()</code> on the deferred event.
    </p>
    <button>Attach manifest</button>
    <!-- <button href="https://crochetnests.github.io/" target="_blank">Link</button> -->
    <script>

      /*
      */
        var button = document.querySelector('button');
        button.addEventListener('click', () => {
          /*
          const myDynamicManifest = {
          "name": "PWA Test",
          "short_name": "PWA Test",
          "background_color": "#FFFFFF",
          "display": "standalone",
          "start_url": "./",
          "scope": "./",
          "icons": [
            {
              "src": "https://raw.githubusercontent.com/jeffposnick/create-react-pwa/master/favicon.ico",
              "sizes": "192x192",
              "type": "image/png"
            }
          ],
          "theme_color": "#FFFFFF",
          "related_applications": [],
          "shortcuts": []
        };
        const stringManifest = JSON.stringify(myDynamicManifest);
        const blob = new Blob([stringManifest], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        document.querySelector('#my-manifest').setAttribute('href', manifestURL);
        */
        });
      
      document.querySelector('#my-manifest').setAttribute('href', '/manifest.json');

      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js');

        window.addEventListener('beforeinstallprompt', event => {
          event.preventDefault();
          var button = document.querySelector('button');
          button.innerHTML = "before install prompt";
          button.addEventListener('click', () => {
            event.prompt();
          });

        });
      }
    </script>
  </body>
</html>
